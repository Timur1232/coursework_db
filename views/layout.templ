package views

import (
    "github.com/Timur1232/coursework_db/internal/db"
)

templ Layout(title string, content templ.Component, user *db.Users) {
	<!DOCTYPE html>
	<html lang="ru">
		<head>
			<meta charset="UTF-8"/>
			<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
			<title>{ title }</title>
			<link rel="stylesheet" href="/static/styles/style.css"/>
			<link rel="icon" href="/static/favicon.ico"/>
			<script src="https://unpkg.com/htmx.org@1.9.10"></script>
			<script src="https://unpkg.com/hyperscript.org@0.9.12"></script>
		</head>
		<body>
			@Header(user)
			<main class="main-content">
				@content
			</main>
		</body>
	</html>
}

templ Header(user *db.Users) {
	<header class="header">
		<div class="header-container">
			<div class="header-brand">
				<a href="/" class="logo-link" hx-get="/" hx-push-url="true" hx-target="body" hx-swap="outerHTML">
					<div class="logo">
						<span class="logo-text">Спасательная Служба</span>
					</div>
				</a>
			</div>
			<nav class="header-nav">
				<ul class="nav-list">
					<li class="nav-item">
						<a
							href="/"
							class="nav-link"
							hx-get="/"
							hx-push-url="true"
							hx-target=".main-content"
							hx-swap="innerHTML"
							:class="{'active': window.location.pathname === '/'}"
						>
							<span>Главная</span>
						</a>
					</li>
					<li class="nav-item">
						<a
							href="/profile"
							class="nav-link"
							hx-get="/profile"
							hx-push-url="true"
							hx-target=".main-content"
							hx-swap="innerHTML"
							:class="{'active': window.location.pathname.startsWith('/profile')}"
						>
							<span>Личный кабинет</span>
						</a>
					</li>
					<li class="nav-item">
						<a
							href="/admin"
							class="nav-link"
							hx-get="/admin"
							hx-push-url="true"
							hx-target="main"
							hx-swap="innerHTML"
							:class="{'active': window.location.pathname.startsWith('/admin')}"
						>
							<span>Панель администратора</span>
						</a>
					</li>
				</ul>
			</nav>
            if user != nil {
			<div id="header-user" class="header-user">
				<div class="user-info">
					<div class="user-details">
						<span class="user-name">{ user.Login }</span>
						<span class="user-role">{ user.TranslateRole() }</span>
					</div>
				</div>
				<button
					class="logout-btn"
					hx-post="/logout"
					hx-confirm="Вы уверены, что хотите выйти?"
					hx-target="main"
					hx-swap="innerHTML"
					hx-push-url="/login"
				>
					<span>Выйти</span>
				</button>
			</div>
            } else {
                @NotAuthorized(false)
            }
		</div>
	</header>
}
